## 1.**项目概述**

**PHPAuthScanner** 是一款专为PHP代码审计设计的自动化安全审计工具，用于检测PHP项目中的方法文件是否鉴权，用于未鉴权文件筛选，更快速的帮我们筛选出未进行鉴权的文件，提升我们挖掘前台漏洞的效率。它通过扫描项目文件，检查是否缺少必要的身份验证代码（如`session`、`auth`、`login`等关键字），帮助开发者快速识别潜在的安全风险。

![image-20250508095455720](https://github.com/caigo8/picx-images-hosting/raw/master/PHPAuthScanner/image-20250508095455720.60ugjgtc4p.webp)

------

## 2.**主要功能**

✅ **图形化GUI**

- 无需命令行交互，鼠标点点即可🐒

✅ **多目录扫描**

- 考虑到Thinkphp等框架的目录结构特殊，加上了多目录扫描，在面对框架时减少无用文件扫描

✅ **自定义关键词匹配**

- 可配置关键词（如 `session`、`auth`、`AdminBase` 等），灵活适应不同框架。

✅ **智能正则表达式生成**

- 自动生成匹配规则，检测变量、函数调用、类继承等鉴权逻辑。

✅ **可视化报告输出**

- 生成易读的扫描报告，列出所有未鉴权的PHP文件路径。

✅ **独立EXE可执行文件**

- 支持打包成Windows可执行文件（.exe），无需Python环境即可运行

------

## 3.**适用场景**

🔹 **代码安全审计**：检查PHP项目是否存在未授权访问风险。
🔹 **渗透测试辅助**：快速定位可能的安全漏洞。
🔹 **开发规范检查**：确保代码符合安全编码标准。

## 4.**技术栈**

- **开发语言**：Python 3.10+
- **核心库**：`re`（正则表达式）、`os`（文件系统操作）
- **GUI框架**：`tkinter`（跨平台界面）
- **打包工具**：`PyInstaller`（生成独立EXE）
- **图标处理**：`Pillow`（图像支持）

------

## 5.**使用说明**

### 5.1**运行方式**

#### **方式1：直接运行Python脚本**

```
python start.py
```

#### **方式2：使用打包好的EXE**

```
PHPAuthScanner.exe  # 双击运行
```

### 5.2**操作步骤**

1. **添加扫描目录**：选择要检查的PHP项目文件夹。
2. **设置关键词**（可选）：默认包含 `session`、`auth` 等常见鉴权关键词。
3. **开始扫描**：自动分析所有PHP文件。
4. **查看结果**：显示未鉴权的文件列表。
5. **导出报告**：保存结果为 `scan_results.txt`。

### 5.3在线视频演示

https://easylink.cc/mk655s

------

## **6. 项目结构**

```
PHPAuthScanner/
│── caigosec.ico           # 应用程序图标
│── scanner_core.py    # 核心扫描逻辑
│── scanner_gui.py     # 图形用户界面
│── start.py            # 程序入口
│── build.py           # 打包脚本（可选）
└── README.md          # 项目说明文档
```

------

## **7. 打包指南**

```
# 安装PyInstaller
python -m pip install pyinstaller

# 打包成EXE（单文件）
python build.py
```

生成的EXE位于 `dist/` 目录下。

------

## **8. 注意事项**

⚠ **误报处理**：部分框架可能使用自定义鉴权方式，需手动调整关键词。
⚠ **性能优化**：超大项目建议分批扫描。
⚠ **安全建议**：扫描结果需人工复核，不可完全依赖自动化工具。

------

## **9. 未来改进**

🛠 **支持更多框架**（如Laravel、Symfony专用规则）
🛠 **增加API模式**（集成CI/CD流水线）
🛠 **增强正则规则**（检测OAuth、JWT等鉴权方式）

------

## **10. 贡献与反馈**

欢迎提交Issue或PR！
**联系方式**：

![946b335182f59f601607f324439409d](https://github.com/caigo8/picx-images-hosting/raw/master/PHPAuthScanner/946b335182f59f601607f324439409d.2a5ay84r03.webp)

------

**© 2025 PHP鉴权扫描工具 | 开发者：C@ig0**
